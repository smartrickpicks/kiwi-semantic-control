{
  "version": "v1.2.5-testability",
  "problem_statement": {
    "issue": "Preview dataset is gone, so structured intent dropdowns can't be exercised end-to-end.",
    "secondary_need": "You want to see (and test) where the Loader of documents will live in the app flow."
  },
  "root_causes_likely": [
    "localStorage was cleared (new keys, schema migration, or browser refresh)",
    "the previous seeded demo dataset was removed during refactor",
    "no persistent 'Sample Dataset' artifact exists in-repo to rehydrate test state"
  ],
  "decisions": {
    "offline_first": true,
    "testability_requires": [
      "a deterministic in-repo sample dataset",
      "a one-click 'Load Sample Dataset' action",
      "a visible Loader entry point in the left nav"
    ],
    "loader_scope_v1": "Local file import only (CSV/XLSX now; PDF attachment as artifact ref; no network)."
  },
  "tasks": [
    {
      "id": "V1-LOADER-ENTRY-001",
      "owner": "Replit",
      "title": "Add Loader as a first-class nav item and first-step screen",
      "description": "Add 'Loader' to the left sidebar. Loader is the entry point for importing datasets and attaching PDFs. After successful load, route to Spreadsheet View.",
      "ui_requirements": [
        "Sidebar item: Loader (top-level)",
        "Main Loader screen with: (1) Load Sample Dataset, (2) Import CSV/XLSX, (3) Attach PDF (optional)",
        "After load: show dataset summary card (sheets, rows, columns) and CTA 'Open Spreadsheet'"
      ],
      "acceptance_criteria": [
        "User can always navigate to Loader from anywhere",
        "Loader is the first step in the workflow (no hidden entry points)",
        "After loading, Spreadsheet View renders with sheets/columns populated"
      ]
    },
    {
      "id": "V1-SEED-DATA-001",
      "owner": "Replit",
      "title": "Restore deterministic Preview Dataset (in-repo) + one-click load",
      "description": "Ship a demo dataset inside the app bundle (JSON or embedded CSV strings) and provide a 'Load Sample Dataset' button that hydrates localStorage and app state.",
      "implementation_notes": [
        "Store sample dataset under /examples/datasets/sample_v1.json (or equivalent)",
        "Ensure dataset contains at least: accounts + catalog sheets with fields used in intent dropdowns (e.g., catalog.artist_name)",
        "Hydrate: dataset_store + schema index + sheet list + field list",
        "Write a stable dataset_id like 'sample_v1' so it can be reloaded"
      ],
      "acceptance_criteria": [
        "Clicking 'Load Sample Dataset' always produces the same sheets/fields (deterministic)",
        "Target Field dropdown is populated immediately after loading",
        "Structured intent can be submitted end-to-end using sample data"
      ]
    },
    {
      "id": "V1-RESET-TOOLS-001",
      "owner": "Replit",
      "title": "Add Test Utilities: Reset Demo State + Rebuild Index",
      "description": "Add a small 'Test Utilities' section on the Loader screen: Reset local demo state, reload sample dataset, rebuild field index.",
      "acceptance_criteria": [
        "Reset clears only app keys (namespaced) and does not nuke unrelated localStorage",
        "Reload sample dataset restores expected dropdown options",
        "Rebuild index fixes missing dropdown values without reload"
      ]
    },
    {
      "id": "V1-IMPORT-CSV-XLSX-001",
      "owner": "Replit",
      "title": "Implement local CSV/XLSX import into dataset model",
      "description": "Allow user to import CSV or XLSX from disk into the dataset store and generate schema/field index used by dropdowns.",
      "constraints": [
        "No network calls",
        "Persist dataset in localStorage (or IndexedDB if already used)",
        "Support multi-sheet XLSX"
      ],
      "acceptance_criteria": [
        "CSV import creates 1 sheet with columns detected",
        "XLSX import creates multiple sheets with proper column sets",
        "Target Field dropdown shows sheet.field values from imported data"
      ]
    },
    {
      "id": "V1-PDF-ATTACH-001",
      "owner": "Replit",
      "title": "Add PDF attachment to dataset/session as an artifact reference",
      "description": "Allow attaching a local PDF file to the current dataset/session as an artifact ref. No parsing required in V1; just persist metadata and enable PDF Viewer to open it later.",
      "fields_to_store": [
        "pdf_artifact_id",
        "file_name",
        "file_size_bytes",
        "added_at_utc",
        "local_object_url_or_storage_ref"
      ],
      "acceptance_criteria": [
        "User can attach a PDF from Loader",
        "PDF appears in Workbench viewer when referenced",
        "PDF attachment persists across refresh (within the same local machine profile)"
      ]
    }
  ],
  "expected_user_test_flow_after_v1_2_5": [
    "Open app -> click Loader",
    "Click 'Load Sample Dataset'",
    "Click 'Open Spreadsheet'",
    "Open any record -> Patch Studio tab",
    "Verify Target Field dropdown populated",
    "Select Condition Type + Action Type + Comment",
    "Confirm Live Intent Preview updates",
    "Submit to Patch Queue and verify it appears in Admin Console"
  ],
  "miro_prompt": {
    "text": "Add/confirm 'Loader' as the first node in the V1 offline-first workflow. Under Loader, include three sub-actions: (1) Load Sample Dataset (deterministic), (2) Import CSV/XLSX (local), (3) Attach PDF (artifact ref). Connect Loader -> Spreadsheet View -> Record Workbench -> Patch Studio. Add a small 'Test Utilities' note on Loader: Reset Demo State / Rebuild Field Index."
  }
}