{
  "ROUTE": "BUILD_TASK_CODEX",
  "goal": "Refine the SRR Patch Editor/Evidence Pack to reduce analyst load and make patch semantics deterministic and patch-type driven.",
  "files_in_scope": [
    "ui/viewer/index.html",
    "docs/ui/views/single_row_review_view.md",
    "docs/handoff/TASKS_UI.md"
  ],
  "constraints": [
    "Offline-first only; no network calls.",
    "Keep canonical tokens in docs (single_row_review, submit_patch_request).",
    "No invented completion claims; use “Unknown — requires audit” where needed."
  ],
  "implementation_steps": [
    {
      "step": "Patch Editor UI",
      "details": [
        "Add Patch Type selector: Correction, Blacklist Flag, RFI (Question).",
        "Old/New values: Old locked with subdued styling; New editable and prominent.",
        "Add Override toggle only when applicable (Observation = Override Needed OR Expected = Allow Override).",
        "Add Blacklist Subject (read-only derived from selected field/value).",
        "Add RFI Target input (optional)."
      ]
    },
    {
      "step": "Evidence Pack",
      "details": [
        "Observation dropdown only (no text area).",
        "Expected dropdown only (no text area).",
        "Justification = single narrative textarea.",
        "Repro Method dropdown + file input appears only when required (Correction + rule-failure mode).",
        "Repro methods: Breaks Salesforce Rule, Breaks QA Gate, Resolver Mismatch, Doc Evidence Mismatch (requires file attachment)."
      ]
    },
    {
      "step": "Patch Type behavior",
      "details": [
        "Correction: Observation + Expected + Justification required; Repro shown only when required.",
        "Blacklist Flag: Justification only; no Observation/Expected/Repro.",
        "RFI: Justification only + optional RFI Target; no Observation/Expected/Repro."
      ]
    },
    {
      "step": "Override behavior",
      "details": [
        "When Override is enabled: repro not required.",
        "Add Override badge in patch summary header."
      ]
    },
    {
      "step": "Docs + Backlog",
      "details": [
        "Update SRR view doc to reflect the new Evidence Pack structure.",
        "Append TASKS_UI backlog item for this refinement with acceptance tests and “Unknown — requires audit”."
      ]
    }
  ],
  "acceptance_tests": [
    "Old/New values are visually prominent; Old locked; New reflects edited value.",
    "Observation/Expected are dropdown-only; only one narrative textarea exists.",
    "Patch Type changes visible form sections.",
    "Repro controls appear only when required.",
    "Override badge appears and suppresses repro requirement.",
    "Docs updated to match UI and TASKS_UI updated with a new backlog item."
  ],
  "suggested_commit_message": "feat(ui): refine Evidence Pack + Patch Editor semantics"
}
