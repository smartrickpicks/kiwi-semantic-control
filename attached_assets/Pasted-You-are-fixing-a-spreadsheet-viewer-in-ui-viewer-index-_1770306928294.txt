You are fixing a spreadsheet viewer in `ui/viewer/index.html` under `/Users/zacharyholwerda/Downloads/kiwi-semantic-control 2/`.

Issues to fix:
1) Field list shows a combined count across all sheets (e.g., “99 fields”). It must be sheet‑specific for the active sheet in the Excel file.
2) XLSX import sometimes misses fields or shows gaps. Mapping and sheet data aren’t consistent per sheet.
3) Old highlight colors (cell/row) persist after uploading a new file and must be fully cleared on file change.

Key code locations:
- Field list dropdown: `populateTargetFieldDropdown()` around lines 20712-20754.
- XLSX parsing: `parseWorkbook()` around lines 5062-5123.
- File import: `handleFileImport()` around lines 18569-18685.
- CSV import: `handleCSVImport()` around lines 22987-23060.
- Cache clearing: `clearAllCellStores()` around lines 11145-11158.
- Sheet selector: `populateGridSheetSelector()` around lines 10423-10466.
- Dataset activation + sample load: `activateDataset()` around lines 22737-22771 and `loadSampleDataset()` around lines 22855-22943.

Required changes:
A) Make target field list sheet‑specific.
- Use the active sheet (grid selector, or current SRR sheet, or workbook.activeSheet).
- Filter `bundle.field_index` to only include entries for that sheet.
- If no sheet is selected, default to the first sheet deterministically.
- Make sure the list updates when the active sheet changes.

B) Fix XLSX mapping per sheet.
- In `parseWorkbook()`, resolve column mapping per sheet (not only the first sheet).
- Apply `resolveColumnMapping(headers)` for each sheet and use that mapping when calling `applyColumnMapping`.

C) Persist sheet data into `allData.sheets` on import.
- In `handleFileImport()` and `handleCSVImport()`, set `allData.sheets` to the actual workbook sheets with headers/rows.
- This makes `getCurrentBundle()` accurate and prevents missing fields.

D) Fully clear highlight caches when changing files.
- Expand `clearAllCellStores()` to also clear any cached patch/row highlight stores, e.g. `recordPatchSummaryStore`, `cellStylesStore`, and any other highlight caches in this file.
- Call `clearAllCellStores()` at every dataset switch, including `loadSampleDataset()` and `activateDataset()` (not just file import).

E) Reset invalid sheet selection on new load.
- If `gridState.sheet` points to a sheet that doesn’t exist in the newly loaded workbook, reset it to the first available sheet before rendering.

Acceptance criteria:
- Field dropdown shows only fields for the currently selected sheet.
- Loading a new file does not show highlight colors from previous files.
- XLSX sheets with different headers load correctly (no missing columns caused by first‑sheet mapping).
- Grid shows data for the new file without requiring manual “sheet reselect” to clear empty view.

Optional test steps:
- Upload an XLSX with 2 sheets that have different headers.
- Confirm “Field list” only includes fields from Sheet A, then switch to Sheet B and list updates.
- Upload a different file and ensure highlights are gone.
